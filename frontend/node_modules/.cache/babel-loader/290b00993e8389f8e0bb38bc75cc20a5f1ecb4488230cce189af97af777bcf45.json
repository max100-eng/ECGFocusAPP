{"ast":null,"code":"import{useState,useEffect,useRef}from'react';import{getAuth,signInAnonymously,signInWithCustomToken}from'firebase/auth';import{initializeApp}from'firebase/app';// Define las variables globales proporcionadas por el entorno de Canvas\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const firebaseConfig=typeof __firebase_config!=='undefined'?JSON.parse(__firebase_config):{};const initialAuthToken=typeof __initial_auth_token!=='undefined'?__initial_auth_token:null;const appId=typeof __app_id!=='undefined'?__app_id:'default-app-id';// Se inicializa Firebase con las configuraciones dadas.\nconst app=initializeApp(firebaseConfig);const auth=getAuth(app);// Se define el componente principal de la aplicación.\nexport default function App(){const[prompt,setPrompt]=useState('');const[image,setImage]=useState(null);const[response,setResponse]=useState('');const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState('');const[pathologicalFindings,setPathologicalFindings]=useState('');const canvasRef=useRef(null);// Se maneja la autenticación de Firebase al cargar la aplicación.\nuseEffect(()=>{const authenticate=async()=>{try{if(initialAuthToken){// Se usa el token personalizado para iniciar sesión si está disponible.\nawait signInWithCustomToken(auth,initialAuthToken);}else{// Se usa el inicio de sesión anónimo si no hay token.\nawait signInAnonymously(auth);}}catch(e){console.error('Error de autenticación:',e);setError(\"Error de autenticaci\\xF3n: \".concat(e.message));}};authenticate();},[]);// Efecto para dibujar el gráfico ECG en el canvas cuando la respuesta cambia.\nuseEffect(()=>{const canvas=canvasRef.current;if(canvas&&response){drawECG(canvas,response);}},[response]);// Función para dibujar una simulación del ECG en el canvas.\nconst drawECG=(canvas,analysisText)=>{const ctx=canvas.getContext('2d');const width=canvas.width;const height=canvas.height;ctx.clearRect(0,0,width,height);// Dibuja el fondo cuadriculado del ECG\nctx.strokeStyle='#f0f0f0';ctx.lineWidth=1;const gridSize=10;for(let x=0;x<width;x+=gridSize){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,height);ctx.stroke();}for(let y=0;y<height;y+=gridSize){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(width,y);ctx.stroke();}// Dibuja la línea base\nctx.strokeStyle='#000000';ctx.lineWidth=2;ctx.beginPath();const midY=height/2;ctx.moveTo(0,midY);// Simula la onda ECG basándose en el análisis de texto\nconst heartRateMatch=analysisText.match(/Frecuencia cardíaca: (\\d+)/i);const heartRate=heartRateMatch?parseInt(heartRateMatch[1]):70;// Por defecto 70 bpm\nconst segmentLength=200;// Longitud de un ciclo del ECG\nconst speedFactor=70/heartRate;let x=0;while(x<width){// Onda P\nctx.quadraticCurveTo(x+10,midY-10,x+20,midY);x+=20*speedFactor;// Segmento PR y Complejo QRS\nconst qrsStart=x;ctx.lineTo(x+5,midY+20);// Onda Q\nctx.lineTo(x+10,midY-60);// Onda R\nctx.lineTo(x+15,midY);// Onda S\nx+=15*speedFactor;// Elevación o depresión del segmento ST\nif(analysisText.toLowerCase().includes('elevación del segmento st')){ctx.lineTo(x+20,midY-20);x+=20*speedFactor;}else if(analysisText.toLowerCase().includes('depresión del segmento st')){ctx.lineTo(x+20,midY+20);x+=20*speedFactor;}else{ctx.lineTo(x+20,midY);// Segmento ST normal\nx+=20*speedFactor;}// Onda T\nctx.quadraticCurveTo(x+15,midY-25,x+30,midY);x+=30*speedFactor;}ctx.stroke();};// Función para manejar el envío de la solicitud a la API.\nconst handleAnalyzeImage=async()=>{// Se valida que se haya subido una imagen.\nif(!image){setError('Por favor, sube una imagen.');return;}// Se reinician los estados de respuesta, error y hallazgos.\nsetResponse('');setError('');setIsLoading(true);setPathologicalFindings('');try{// Se lee la imagen subida como un URL de datos base64.\nconst reader=new FileReader();reader.onload=async()=>{try{var _result$candidates,_result$candidates$,_result$candidates$$c,_result$candidates$$c2,_result$candidates$$c3;const base64Data=reader.result.split(',')[1];// Se construye un prompt para un análisis sintético del ECG, pero pidiendo un diagnóstico más profesional y preciso.\nconst ecgAnalysisPrompt=\"\\n            Analiza este electrocardiograma (ECG) de forma profesional y muy precisa.\\n            - **Resumen Cl\\xEDnico:** Un breve resumen con la impresi\\xF3n general del ECG.\\n            - **Hallazgos Clave:** Una lista de puntos importantes (ej. mediciones, ritmo, anomal\\xEDas).\\n            - **Diagn\\xF3stico Diferencial:** Enumera las patolog\\xEDas m\\xE1s probables, usando terminolog\\xEDa m\\xE9dica precisa.\\n            - **Conclusi\\xF3n y Justificaci\\xF3n:** Proporciona el diagn\\xF3stico m\\xE1s probable con una justificaci\\xF3n cl\\xEDnica detallada basada en los hallazgos.\\n            - **Formato:** Responde en espa\\xF1ol, usando listas de vi\\xF1etas y un lenguaje m\\xE9dico riguroso.\\n          \";// Se combina el prompt sintético con el prompt del usuario, si existe.\nconst finalPrompt=prompt?\"\".concat(ecgAnalysisPrompt,\"\\n\\nAdem\\xE1s, considera la siguiente instrucci\\xF3n del usuario: \").concat(prompt):ecgAnalysisPrompt;// Se construye el historial de chat para la API.\nconst chatHistory=[{role:\"user\",parts:[{text:finalPrompt},{inlineData:{mimeType:image.type,data:base64Data}}]}];const payload={contents:chatHistory};// Se usa una clave de API vacía ya que será proporcionada por el entorno de Canvas.\nconst apiKey=\"\";const apiUrl=\"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=\".concat(apiKey);// Se realiza la llamada a la API con un mecanismo de reintento exponencial.\nlet attempts=0;const maxAttempts=5;let apiResponse;while(attempts<maxAttempts){try{apiResponse=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(apiResponse.status!==429){break;// Se sale del bucle si no es un error de \"demasiadas solicitudes\".\n}// Se duplica el tiempo de espera en cada reintento.\nconst delay=2**attempts*1000;console.log(\"Error 429, reintentando en \".concat(delay,\"ms...\"));await new Promise(resolve=>setTimeout(resolve,delay));attempts++;}catch(e){console.error('Error al intentar la llamada a la API:',e);break;}}if(!apiResponse.ok){throw new Error(\"Error de la API: \".concat(apiResponse.status,\" - \").concat(apiResponse.statusText));}const result=await apiResponse.json();const generatedText=result===null||result===void 0?void 0:(_result$candidates=result.candidates)===null||_result$candidates===void 0?void 0:(_result$candidates$=_result$candidates[0])===null||_result$candidates$===void 0?void 0:(_result$candidates$$c=_result$candidates$.content)===null||_result$candidates$$c===void 0?void 0:(_result$candidates$$c2=_result$candidates$$c.parts)===null||_result$candidates$$c2===void 0?void 0:(_result$candidates$$c3=_result$candidates$$c2[0])===null||_result$candidates$$c3===void 0?void 0:_result$candidates$$c3.text;// Se actualiza el estado de la respuesta.\nif(generatedText){setResponse(generatedText);// Se revisa la respuesta en busca de hallazgos patológicos para la alerta.\nconst findings=checkPathologicalFindings(generatedText);setPathologicalFindings(findings);}else{setResponse('No se pudo generar una respuesta. Intenta con un prompt diferente.');}}catch(e){console.error('Error al analizar la imagen:',e);setError(\"Error: \".concat(e.message));}finally{setIsLoading(false);}};// Se inicia la lectura del archivo de imagen.\nreader.onerror=e=>{console.error('Error al leer el archivo:',e);setError('No se pudo leer el archivo de imagen.');setIsLoading(false);};reader.readAsDataURL(image);}catch(e){console.error('Error general de la aplicación:',e);setError(\"Error general de la aplicaci\\xF3n: \".concat(e.message));setIsLoading(false);}};// Función auxiliar para buscar palabras clave de hallazgos patológicos.\nconst checkPathologicalFindings=text=>{const keywords=['arritmia','taquicardia','bradicardia','isquemia','iam','angina','bloqueo','alteración','elevación','depresión'];const lowerCaseText=text.toLowerCase();const detected=keywords.filter(keyword=>lowerCaseText.includes(keyword));return detected.length>0?\"Hallazgo(s) patol\\xF3gico(s) detectado(s): \".concat(detected.join(', ')):'';};// El botón ahora se habilita solo si hay una imagen y no está cargando.\nconst isButtonDisabled=isLoading||!image;return/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4 font-sans\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-2xl bg-white shadow-xl rounded-2xl p-8 space-y-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-center text-gray-800\",children:\"Analizador de Im\\xE1genes de ECG con IA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image-upload\",className:\"block text-gray-700 font-semibold\",children:\"Sube la imagen de un ECG:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"image-upload\",accept:\"image/*\",onChange:e=>setImage(e.target.files[0]),className:\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100\"}),image&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(image),alt:\"Vista previa\",className:\"max-h-64 mx-auto rounded-lg shadow-md\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-2 text-sm text-gray-600\",children:[\"Archivo seleccionado: \",image.name]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:/*#__PURE__*/_jsx(\"textarea\",{id:\"prompt-input\",value:prompt,onChange:e=>setPrompt(e.target.value),placeholder:\"A\\xF1ade instrucciones espec\\xEDficas si quieres. Ej: 'presta atenci\\xF3n al segmento ST'.\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 transition duration-200 resize-none\",rows:\"4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAnalyzeImage,disabled:isButtonDisabled,className:\"w-full py-3 px-6 text-white font-bold bg-violet-600 rounded-lg shadow-lg hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2 disabled:bg-violet-300 transition duration-200\",title:isButtonDisabled?\"Sube una imagen para habilitar este botón\":\"Analiza el ECG\",children:isLoading?/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 text-white mx-auto\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}):'Analizar ECG'}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-red-100 text-red-700 rounded-lg border border-red-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Error:\"}),/*#__PURE__*/_jsx(\"p\",{children:error})]}),pathologicalFindings&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-red-500 text-white rounded-lg border-2 border-red-700 shadow-md animate-pulse\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-center\",children:\"\\xA1ALERTA! Posible hallazgo patol\\xF3gico\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-1\",children:pathologicalFindings})]}),response&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-gray-50 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"Representaci\\xF3n del ECG:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"relative\",children:/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:\"600\",height:\"200\",className:\"w-full bg-white border border-gray-300 rounded-md\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-gray-50 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"An\\xE1lisis de la IA:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 whitespace-pre-wrap\",children:response}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-4 bg-yellow-100 text-yellow-800 rounded-lg font-semibold\",children:\"**Aviso: Este an\\xE1lisis es generado por una inteligencia artificial y tiene fines informativos. No sustituye la evaluaci\\xF3n, diagn\\xF3stico o tratamiento de un profesional m\\xE9dico calificado. Consulta siempre a un m\\xE9dico.**\"})]})]})]})});}","map":{"version":3,"names":["useState","useEffect","useRef","getAuth","signInAnonymously","signInWithCustomToken","initializeApp","jsx","_jsx","jsxs","_jsxs","firebaseConfig","__firebase_config","JSON","parse","initialAuthToken","__initial_auth_token","appId","__app_id","app","auth","App","prompt","setPrompt","image","setImage","response","setResponse","isLoading","setIsLoading","error","setError","pathologicalFindings","setPathologicalFindings","canvasRef","authenticate","e","console","concat","message","canvas","current","drawECG","analysisText","ctx","getContext","width","height","clearRect","strokeStyle","lineWidth","gridSize","x","beginPath","moveTo","lineTo","stroke","y","midY","heartRateMatch","match","heartRate","parseInt","segmentLength","speedFactor","quadraticCurveTo","qrsStart","toLowerCase","includes","handleAnalyzeImage","reader","FileReader","onload","_result$candidates","_result$candidates$","_result$candidates$$c","_result$candidates$$c2","_result$candidates$$c3","base64Data","result","split","ecgAnalysisPrompt","finalPrompt","chatHistory","role","parts","text","inlineData","mimeType","type","data","payload","contents","apiKey","apiUrl","attempts","maxAttempts","apiResponse","fetch","method","headers","body","stringify","status","delay","log","Promise","resolve","setTimeout","ok","Error","statusText","json","generatedText","candidates","content","findings","checkPathologicalFindings","onerror","readAsDataURL","keywords","lowerCaseText","detected","filter","keyword","length","join","isButtonDisabled","className","children","htmlFor","id","accept","onChange","target","files","src","URL","createObjectURL","alt","name","value","placeholder","rows","onClick","disabled","title","xmlns","fill","viewBox","cx","cy","r","strokeWidth","d","ref"],"sources":["C:/Users/maram/Focus_ECG/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { getAuth, signInAnonymously, signInWithCustomToken } from 'firebase/auth';\r\nimport { initializeApp } from 'firebase/app';\r\n\r\n// Define las variables globales proporcionadas por el entorno de Canvas\r\nconst firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};\r\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\r\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\r\n\r\n// Se inicializa Firebase con las configuraciones dadas.\r\nconst app = initializeApp(firebaseConfig);\r\nconst auth = getAuth(app);\r\n\r\n// Se define el componente principal de la aplicación.\r\nexport default function App() {\r\n  const [prompt, setPrompt] = useState('');\r\n  const [image, setImage] = useState(null);\r\n  const [response, setResponse] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [pathologicalFindings, setPathologicalFindings] = useState('');\r\n  const canvasRef = useRef(null);\r\n\r\n  // Se maneja la autenticación de Firebase al cargar la aplicación.\r\n  useEffect(() => {\r\n    const authenticate = async () => {\r\n      try {\r\n        if (initialAuthToken) {\r\n          // Se usa el token personalizado para iniciar sesión si está disponible.\r\n          await signInWithCustomToken(auth, initialAuthToken);\r\n        } else {\r\n          // Se usa el inicio de sesión anónimo si no hay token.\r\n          await signInAnonymously(auth);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error de autenticación:', e);\r\n        setError(`Error de autenticación: ${e.message}`);\r\n      }\r\n    };\r\n    authenticate();\r\n  }, []);\r\n\r\n  // Efecto para dibujar el gráfico ECG en el canvas cuando la respuesta cambia.\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (canvas && response) {\r\n      drawECG(canvas, response);\r\n    }\r\n  }, [response]);\r\n\r\n  // Función para dibujar una simulación del ECG en el canvas.\r\n  const drawECG = (canvas, analysisText) => {\r\n    const ctx = canvas.getContext('2d');\r\n    const width = canvas.width;\r\n    const height = canvas.height;\r\n    ctx.clearRect(0, 0, width, height);\r\n\r\n    // Dibuja el fondo cuadriculado del ECG\r\n    ctx.strokeStyle = '#f0f0f0';\r\n    ctx.lineWidth = 1;\r\n    const gridSize = 10;\r\n    for (let x = 0; x < width; x += gridSize) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(x, 0);\r\n      ctx.lineTo(x, height);\r\n      ctx.stroke();\r\n    }\r\n    for (let y = 0; y < height; y += gridSize) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, y);\r\n      ctx.lineTo(width, y);\r\n      ctx.stroke();\r\n    }\r\n\r\n    // Dibuja la línea base\r\n    ctx.strokeStyle = '#000000';\r\n    ctx.lineWidth = 2;\r\n    ctx.beginPath();\r\n    const midY = height / 2;\r\n    ctx.moveTo(0, midY);\r\n\r\n    // Simula la onda ECG basándose en el análisis de texto\r\n    const heartRateMatch = analysisText.match(/Frecuencia cardíaca: (\\d+)/i);\r\n    const heartRate = heartRateMatch ? parseInt(heartRateMatch[1]) : 70; // Por defecto 70 bpm\r\n    const segmentLength = 200; // Longitud de un ciclo del ECG\r\n    const speedFactor = 70 / heartRate;\r\n    let x = 0;\r\n    \r\n    while (x < width) {\r\n      // Onda P\r\n      ctx.quadraticCurveTo(x + 10, midY - 10, x + 20, midY);\r\n      x += 20 * speedFactor;\r\n\r\n      // Segmento PR y Complejo QRS\r\n      const qrsStart = x;\r\n      ctx.lineTo(x + 5, midY + 20); // Onda Q\r\n      ctx.lineTo(x + 10, midY - 60); // Onda R\r\n      ctx.lineTo(x + 15, midY); // Onda S\r\n      x += 15 * speedFactor;\r\n      \r\n      // Elevación o depresión del segmento ST\r\n      if (analysisText.toLowerCase().includes('elevación del segmento st')) {\r\n        ctx.lineTo(x + 20, midY - 20);\r\n        x += 20 * speedFactor;\r\n      } else if (analysisText.toLowerCase().includes('depresión del segmento st')) {\r\n        ctx.lineTo(x + 20, midY + 20);\r\n        x += 20 * speedFactor;\r\n      } else {\r\n        ctx.lineTo(x + 20, midY); // Segmento ST normal\r\n        x += 20 * speedFactor;\r\n      }\r\n\r\n      // Onda T\r\n      ctx.quadraticCurveTo(x + 15, midY - 25, x + 30, midY);\r\n      x += 30 * speedFactor;\r\n    }\r\n    \r\n    ctx.stroke();\r\n  };\r\n\r\n  // Función para manejar el envío de la solicitud a la API.\r\n  const handleAnalyzeImage = async () => {\r\n    // Se valida que se haya subido una imagen.\r\n    if (!image) {\r\n      setError('Por favor, sube una imagen.');\r\n      return;\r\n    }\r\n\r\n    // Se reinician los estados de respuesta, error y hallazgos.\r\n    setResponse('');\r\n    setError('');\r\n    setIsLoading(true);\r\n    setPathologicalFindings('');\r\n\r\n    try {\r\n      // Se lee la imagen subida como un URL de datos base64.\r\n      const reader = new FileReader();\r\n      reader.onload = async () => {\r\n        try {\r\n          const base64Data = reader.result.split(',')[1];\r\n          \r\n          // Se construye un prompt para un análisis sintético del ECG, pero pidiendo un diagnóstico más profesional y preciso.\r\n          const ecgAnalysisPrompt = `\r\n            Analiza este electrocardiograma (ECG) de forma profesional y muy precisa.\r\n            - **Resumen Clínico:** Un breve resumen con la impresión general del ECG.\r\n            - **Hallazgos Clave:** Una lista de puntos importantes (ej. mediciones, ritmo, anomalías).\r\n            - **Diagnóstico Diferencial:** Enumera las patologías más probables, usando terminología médica precisa.\r\n            - **Conclusión y Justificación:** Proporciona el diagnóstico más probable con una justificación clínica detallada basada en los hallazgos.\r\n            - **Formato:** Responde en español, usando listas de viñetas y un lenguaje médico riguroso.\r\n          `;\r\n          \r\n          // Se combina el prompt sintético con el prompt del usuario, si existe.\r\n          const finalPrompt = prompt\r\n            ? `${ecgAnalysisPrompt}\\n\\nAdemás, considera la siguiente instrucción del usuario: ${prompt}`\r\n            : ecgAnalysisPrompt;\r\n\r\n          // Se construye el historial de chat para la API.\r\n          const chatHistory = [{\r\n            role: \"user\",\r\n            parts: [\r\n              { text: finalPrompt },\r\n              {\r\n                inlineData: {\r\n                  mimeType: image.type,\r\n                  data: base64Data\r\n                }\r\n              }\r\n            ]\r\n          }];\r\n\r\n          const payload = {\r\n            contents: chatHistory\r\n          };\r\n\r\n          // Se usa una clave de API vacía ya que será proporcionada por el entorno de Canvas.\r\n          const apiKey = \"\";\r\n          const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;\r\n\r\n          // Se realiza la llamada a la API con un mecanismo de reintento exponencial.\r\n          let attempts = 0;\r\n          const maxAttempts = 5;\r\n          let apiResponse;\r\n          \r\n          while (attempts < maxAttempts) {\r\n            try {\r\n              apiResponse = await fetch(apiUrl, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(payload)\r\n              });\r\n\r\n              if (apiResponse.status !== 429) {\r\n                break; // Se sale del bucle si no es un error de \"demasiadas solicitudes\".\r\n              }\r\n\r\n              // Se duplica el tiempo de espera en cada reintento.\r\n              const delay = 2 ** attempts * 1000;\r\n              console.log(`Error 429, reintentando en ${delay}ms...`);\r\n              await new Promise(resolve => setTimeout(resolve, delay));\r\n              attempts++;\r\n            } catch (e) {\r\n              console.error('Error al intentar la llamada a la API:', e);\r\n              break;\r\n            }\r\n          }\r\n          \r\n          if (!apiResponse.ok) {\r\n              throw new Error(`Error de la API: ${apiResponse.status} - ${apiResponse.statusText}`);\r\n          }\r\n\r\n          const result = await apiResponse.json();\r\n          const generatedText = result?.candidates?.[0]?.content?.parts?.[0]?.text;\r\n          \r\n          // Se actualiza el estado de la respuesta.\r\n          if (generatedText) {\r\n            setResponse(generatedText);\r\n            \r\n            // Se revisa la respuesta en busca de hallazgos patológicos para la alerta.\r\n            const findings = checkPathologicalFindings(generatedText);\r\n            setPathologicalFindings(findings);\r\n          } else {\r\n            setResponse('No se pudo generar una respuesta. Intenta con un prompt diferente.');\r\n          }\r\n        } catch (e) {\r\n          console.error('Error al analizar la imagen:', e);\r\n          setError(`Error: ${e.message}`);\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      };\r\n\r\n      // Se inicia la lectura del archivo de imagen.\r\n      reader.onerror = (e) => {\r\n        console.error('Error al leer el archivo:', e);\r\n        setError('No se pudo leer el archivo de imagen.');\r\n        setIsLoading(false);\r\n      };\r\n      reader.readAsDataURL(image);\r\n\r\n    } catch (e) {\r\n      console.error('Error general de la aplicación:', e);\r\n      setError(`Error general de la aplicación: ${e.message}`);\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Función auxiliar para buscar palabras clave de hallazgos patológicos.\r\n  const checkPathologicalFindings = (text) => {\r\n    const keywords = ['arritmia', 'taquicardia', 'bradicardia', 'isquemia', 'iam', 'angina', 'bloqueo', 'alteración', 'elevación', 'depresión'];\r\n    const lowerCaseText = text.toLowerCase();\r\n    const detected = keywords.filter(keyword => lowerCaseText.includes(keyword));\r\n    return detected.length > 0 ? `Hallazgo(s) patológico(s) detectado(s): ${detected.join(', ')}` : '';\r\n  };\r\n\r\n  // El botón ahora se habilita solo si hay una imagen y no está cargando.\r\n  const isButtonDisabled = isLoading || !image;\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4 font-sans\">\r\n      <div className=\"w-full max-w-2xl bg-white shadow-xl rounded-2xl p-8 space-y-6\">\r\n        <h1 className=\"text-3xl font-bold text-center text-gray-800\">\r\n          Analizador de Imágenes de ECG con IA\r\n        </h1>\r\n\r\n        <div className=\"space-y-4\">\r\n          <label htmlFor=\"image-upload\" className=\"block text-gray-700 font-semibold\">\r\n            Sube la imagen de un ECG:\r\n          </label>\r\n          <input\r\n            type=\"file\"\r\n            id=\"image-upload\"\r\n            accept=\"image/*\"\r\n            onChange={(e) => setImage(e.target.files[0])}\r\n            className=\"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100\"\r\n          />\r\n          {image && (\r\n            <div className=\"mt-4 text-center\">\r\n              <img src={URL.createObjectURL(image)} alt=\"Vista previa\" className=\"max-h-64 mx-auto rounded-lg shadow-md\" />\r\n              <p className=\"mt-2 text-sm text-gray-600\">Archivo seleccionado: {image.name}</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          <textarea\r\n            id=\"prompt-input\"\r\n            value={prompt}\r\n            onChange={(e) => setPrompt(e.target.value)}\r\n            placeholder=\"Añade instrucciones específicas si quieres. Ej: 'presta atención al segmento ST'.\"\r\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 transition duration-200 resize-none\"\r\n            rows=\"4\"\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleAnalyzeImage}\r\n          disabled={isButtonDisabled}\r\n          className=\"w-full py-3 px-6 text-white font-bold bg-violet-600 rounded-lg shadow-lg hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2 disabled:bg-violet-300 transition duration-200\"\r\n          title={isButtonDisabled ? \"Sube una imagen para habilitar este botón\" : \"Analiza el ECG\"}\r\n        >\r\n          {isLoading ? (\r\n            <svg className=\"animate-spin h-5 w-5 text-white mx-auto\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n            </svg>\r\n          ) : (\r\n            'Analizar ECG'\r\n          )}\r\n        </button>\r\n\r\n        {error && (\r\n          <div className=\"p-4 bg-red-100 text-red-700 rounded-lg border border-red-200\">\r\n            <p className=\"font-semibold\">Error:</p>\r\n            <p>{error}</p>\r\n          </div>\r\n        )}\r\n        \r\n        {pathologicalFindings && (\r\n          <div className=\"p-4 bg-red-500 text-white rounded-lg border-2 border-red-700 shadow-md animate-pulse\">\r\n            <p className=\"font-bold text-center\">¡ALERTA! Posible hallazgo patológico</p>\r\n            <p className=\"text-center mt-1\">{pathologicalFindings}</p>\r\n          </div>\r\n        )}\r\n\r\n        {response && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"p-6 bg-gray-50 rounded-lg border border-gray-200\">\r\n              <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Representación del ECG:</h2>\r\n              <div className=\"relative\">\r\n                <canvas ref={canvasRef} width=\"600\" height=\"200\" className=\"w-full bg-white border border-gray-300 rounded-md\"></canvas>\r\n              </div>\r\n            </div>\r\n            <div className=\"p-6 bg-gray-50 rounded-lg border border-gray-200\">\r\n              <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Análisis de la IA:</h2>\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{response}</p>\r\n              <div className=\"mt-4 p-4 bg-yellow-100 text-yellow-800 rounded-lg font-semibold\">\r\n                **Aviso: Este análisis es generado por una inteligencia artificial y tiene fines informativos. No sustituye la evaluación, diagnóstico o tratamiento de un profesional médico calificado. Consulta siempre a un médico.**\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}